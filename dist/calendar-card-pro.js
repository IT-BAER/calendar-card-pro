let t=!1;var e;!function(t){t[t.ERROR=0]="ERROR",t[t.WARN=1]="WARN",t[t.INFO=2]="INFO",t[t.DEBUG=3]="DEBUG"}(e||(e={}));let n=e.INFO;const i={title:["background: #424242","color: white","display: inline-block","line-height: 20px","text-align: center","border-radius: 20px 0 0 20px","font-size: 12px","font-weight: bold","padding: 4px 8px 4px 12px","margin: 5px 0"].join(";"),version:["background: #4fc3f7","color: white","display: inline-block","line-height: 20px","text-align: center","border-radius: 0 20px 20px 0","font-size: 12px","font-weight: bold","padding: 4px 12px 4px 8px","margin: 5px 0"].join(";"),prefix:["color: #4fc3f7","font-weight: bold"].join(";"),error:["color: #f44336","font-weight: bold"].join(";"),warn:["color: #ff9800","font-weight: bold"].join(";")};function a(a,o=!1){n=o?e.DEBUG:e.INFO,function(e){if(t)return;console.groupCollapsed("%cüìÖ Calendar Card Pro%cv"+e+" ",i.title,i.version),console.log("%c Description: %c A calendar card that supports multiple calendars with individual styling. ","font-weight: bold","font-weight: normal"),console.log("%c GitHub: %c https://github.com/alexpfau/calendar-card-pro ","font-weight: bold","font-weight: normal"),console.groupEnd(),t=!0}(a)}function o(t,...a){n>=e.ERROR&&(a.length>0?console.error(`%c[Calendar-Card-Pro] ${t}`,i.error,...a):console.error(`%c[Calendar-Card-Pro] ${t}`,i.error))}function r(t,...a){n>=e.WARN&&(a.length>0?console.warn(`%c[Calendar-Card-Pro] ${t}`,i.warn,...a):console.warn(`%c[Calendar-Card-Pro] ${t}`,i.warn))}function s(t,...a){n>=e.INFO&&(a.length>0?console.log(`%c[Calendar-Card-Pro] ${t}`,i.prefix,...a):console.log(`%c[Calendar-Card-Pro] ${t}`,i.prefix))}function c(t,...i){n>=e.DEBUG&&(i.length>0?console.log(`[Calendar-Card-Pro] ${t}`,...i):console.log(`[Calendar-Card-Pro] ${t}`))}const l={entities:[],days_to_show:3,max_events_to_show:void 0,show_past_events:!1,refresh_interval:30,cache_duration:30,language:"en",time_24h:!0,show_end_time:!0,show_month:!0,show_location:!0,remove_location_country:!0,title:"",background_color:"var(--ha-card-background)",row_spacing:"5px",additional_card_spacing:"0px",vertical_line_width:"2px",vertical_line_color:"#03a9f4",horizontal_line_width:"0px",horizontal_line_color:"var(--secondary-text-color)",title_font_size:"20px",weekday_font_size:"14px",day_font_size:"26px",month_font_size:"12px",event_font_size:"14px",time_font_size:"12px",location_font_size:"12px",time_location_icon_size:"16px",title_color:"var(--primary-text-color)",weekday_color:"var(--primary-text-color)",day_color:"var(--primary-text-color)",month_color:"var(--primary-text-color)",event_color:"var(--primary-text-color)",time_color:"var(--secondary-text-color)",location_color:"var(--secondary-text-color)",tap_action:{action:"expand"},hold_action:{action:"none"}};function d(t,e){if(!t||0===Object.keys(t).length)return!0;const n=function(t,e){return!t||["entities","days_to_show","show_past_events"].some((n=>{if("entities"===n){const n=t.entities||[],i=e.entities||[],a=new Set(n.map((t=>"string"==typeof t?t:t.entity))),o=new Set(i.map((t=>"string"==typeof t?t:t.entity)));return a.size!==o.size||Array.from(a).some((t=>!o.has(t)))}return JSON.stringify(t[n])!==JSON.stringify(e[n])}))}(t,e),i=(null==t?void 0:t.refresh_interval)!==(null==e?void 0:e.refresh_interval);return(n||i)&&s("Configuration change requires data refresh"),n||i}function h(t){return Object.keys(t).find((t=>t.startsWith("calendar.")))||null}const p={en:{daysOfWeek:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],fullDaysOfWeek:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],months:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],allDay:"all-day",multiDay:"until",at:"at",noEvents:"No upcoming events",loading:"Loading calendar events...",error:"Error: Calendar entity not found or improperly configured"},de:{daysOfWeek:["So","Mo","Di","Mi","Do","Fr","Sa"],fullDaysOfWeek:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],months:["Jan","Feb","M√§r","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],allDay:"ganzt√§gig",multiDay:"bis",at:"um",noEvents:"Keine anstehenden Termine",loading:"Kalendereintr√§ge werden geladen...",error:"Fehler: Kalender-Entity nicht gefunden oder falsch konfiguriert"}};function m(t){const e=(null==t?void 0:t.toLowerCase())||"en";return p[e]||p.en}function u(t,e,n){return function(t,e,n){const i=m(t);return e in i?i[e]:void 0!==n?n:e}(t,e,n)}function v(t,e,n=!1){const i=m(t),a=n?"fullDaysOfWeek":"daysOfWeek";return(e<0||e>6)&&(console.warn(`Calendar-Card-Pro: Invalid day index ${e}. Using default.`),e=0),i[a][e]}function g(t,e){const n=m(t);return(e<0||e>11)&&(console.warn(`Calendar-Card-Pro: Invalid month index ${e}. Using default.`),e=0),n.months[e]}function f(t,e,n="en"){const i=new Date(t.start.dateTime||t.start.date||""),a=new Date(t.end.dateTime||t.end.date||""),o=m(n);if(!t.start.dateTime){const t=new Date(a);return t.setDate(t.getDate()-1),i.toDateString()!==t.toDateString()?function(t,e,n){const i=t.getDate(),a=n.months[t.getMonth()],o="de"===e?`${i}.`:i;return`${n.allDay}, ${n.multiDay} ${o} ${a}`}(t,n,o):o.allDay}return i.toDateString()!==a.toDateString()?function(t,e,n,i){const a=e.getDate(),o=i.months[e.getMonth()],r=i.fullDaysOfWeek[e.getDay()],s="de"===n?`${a}.`:a,c=y(t,!0),l=y(e,!0);return[c,i.multiDay,r+",",s,o,i.at,l].join(" ")}(i,a,n,o):function(t,e,n,i){return n?`${y(t,i)} - ${y(e,i)}`:y(t,i)}(i,a,e.show_end_time,e.time_24h)}function y(t,e=!0){let n=t.getHours();const i=t.getMinutes();if(!e){const t=n>=12?"PM":"AM";return n=n%12||12,`${n}:${i.toString().padStart(2,"0")} ${t}`}return`${n}:${i.toString().padStart(2,"0")}`}function w(t,e=!0){if(!t||!e)return t||"";const n=t.trim(),i=new Set(["Germany","Deutschland","United States","USA","United States of America","United Kingdom","Great Britain","France","Italy","Italia","Spain","Espa√±a","Netherlands","Nederland","Austria","√ñsterreich","Switzerland","Schweiz"]),a=n.split(",").map((t=>t.trim()));if(a.length>0&&i.has(a[a.length-1]))return a.pop(),a.join(", ");const o=n.split(/\s+/);return o.length>0&&i.has(o[o.length-1])?(o.pop(),o.join(" ")):n}async function b(t,e,n,i=!1,a=[]){if(!x(t,e.entities))return{events:a,fromCache:!1,error:null};const c=E(n,e.entities,e.days_to_show,e.show_past_events),l=!i&&$(c,e);if(l)return{events:l,fromCache:!0,error:null};try{const n=e.entities.map((t=>"string"==typeof t?{entity:t,color:"var(--primary-text-color)"}:t)),i=C(e.days_to_show),a=await async function(t,e,n){const i=[];for(const a of e)try{const e=await t.callApi("GET",`calendars/${a.entity}?start=${n.start.toISOString()}&end=${n.end.toISOString()}`);if(!e||!Array.isArray(e)){r(`Invalid response for ${a.entity}`);continue}const o=e.map((t=>Object.assign(Object.assign({},t),{_entityConfig:{entity:a.entity,color:a.color||"var(--primary-text-color)"}})));i.push(...o)}catch(t){o(`Failed to fetch events for ${a.entity}:`,t)}return i}(t,n,i);return s(`Fetched ${a.length} events from ${n.length} calendars`),function(t,e){try{s(`Caching ${e.length} events`);const n={events:e,timestamp:Date.now()};return localStorage.setItem(t,JSON.stringify(n)),null!==T(t)}catch(t){return o("Failed to cache calendar events:",t),!1}}(c,[...a]),{events:[...a],fromCache:!1,error:null}}catch(n){if(o("API error:",n),0===a.length)try{s("Trying fallback to fetch today events");const i="string"==typeof e.entities[0]?e.entities[0]:e.entities[0].entity,a=await async function(t,e){try{const n=new Date,i=new Date(n.getFullYear(),n.getMonth(),n.getDate()),a=new Date(i);a.setHours(23,59,59,999);return await t.callApi("GET",`calendars/${e}?start=${i.toISOString()}&end=${a.toISOString()}`)}catch(t){return null}}(t,i);return{events:a?[...a]:[],fromCache:!1,error:n}}catch(t){return o("Fallback failed:",t),{events:[],fromCache:!1,error:t}}return{events:a,fromCache:!1,error:n}}}async function _(t){const{hass:e,config:n,instanceId:i,force:a,currentEvents:r,callbacks:c}=t;if(!x(e,n.entities))return;const l=E(i,n.entities,n.days_to_show,n.show_past_events);if(!a&&null!==T(l)){const t=$(l,n);if(t)return s(`Using ${t.length} events from cache`),c.setEvents(t),c.setLoading(!1),void c.renderCallback()}s("Fetching events from API"+(a?" (forced refresh)":"")),c.setLoading(!0),c.renderCallback();try{const t=await b(e,n,i,a,r);t.events&&(c.setEvents(t.events),c.updateLastUpdate()),t.error&&o("Error during event update:",t.error)}catch(t){o("Failed to update events:",t)}finally{c.setLoading(!1),c.renderCallback()}}function x(t,e){return!(!t||!e.length)}function C(t){const e=new Date,n=new Date(e.getFullYear(),e.getMonth(),e.getDate()),i=new Date(n),a=parseInt(t.toString())||3;return i.setDate(n.getDate()+a),i.setHours(23,59,59,999),{start:n,end:i}}function T(t,e){try{const n=localStorage.getItem(t);if(!n)return null;const i=JSON.parse(n),a=Date.now(),o=function(t){return 60*((null==t?void 0:t.cache_duration)||30)*1e3}(e);return a-i.timestamp<o?i:(localStorage.removeItem(t),s(`Cache expired and removed for ${t}`),null)}catch(e){r("Cache error:",e);try{localStorage.removeItem(t)}catch(t){}return null}}function $(t,e){const n=T(t,e);return n?[...n.events]:null}function E(t,e,n,i,a){return`calendar_data_${e.map((t=>"string"==typeof t?t:t.entity)).sort().join("_")}_${n}_${i?1:0}`}function D(t){return[t]}function S(t){const e=t[0];return"string"==typeof e?e:e.entity}function k(t,e,n,i,a){if(t&&t.action&&"none"!==t.action)switch(t.action){case"more-info":F(n,i);break;case"navigate":R(t);break;case"call-service":e&&P(e,t);break;case"url":O(t);break;case"expand":a();break;default:r(`Unknown action type: ${t.action}`)}}function I(t,e){if(!M(e))return()=>{};const n={activePointerId:null,pointerStartX:0,pointerStartY:0,pointerStartTime:0,hasMoved:!1,holdTriggered:!1,tapPending:!1,interactionActive:!1,holdTimer:null,holdIndicator:null,tapRipple:null,lastActionTime:0,lastHoldTime:0,tapDisabled:!1,isTouch:"ontouchstart"in window};N(),M(e)&&function(t){s("Applying interaction styles to element",{tagName:t.tagName,classes:t.className}),t.classList.add("card-interactive"),t.classList.add("hover-effect-target"),t.style.cursor="pointer";const e=t.querySelectorAll("ha-card");e.length&&(s("Found ha-card children, applying styles",{count:e.length}),e.forEach((t=>{t.classList.add("card-interactive"),t.classList.add("hover-effect-target")})));let n=t;for(;n;)(n.classList.contains("card-container")||"ha-card"===n.tagName.toLowerCase())&&(s("Found card parent, applying styles",{element:n.tagName,classes:n.className}),n.classList.add("card-interactive"),n.classList.add("hover-effect-target")),n=n.parentElement;"static"===window.getComputedStyle(t).position&&(t.style.position="relative");!function(t){const e=t.querySelectorAll(".card-ripple-container");e.forEach((t=>{var e;try{null===(e=t.parentNode)||void 0===e||e.removeChild(t)}catch(t){}}));const n=document.createElement("div");n.className="card-ripple-container",n.style.position="absolute",n.style.top="0",n.style.left="0",n.style.right="0",n.style.bottom="0",n.style.overflow="hidden",n.style.pointerEvents="none",n.style.zIndex="1",n.style.borderRadius="var(--ha-card-border-radius, 4px)",t.firstChild?t.insertBefore(n,t.firstChild):t.appendChild(n);s("Ripple container created and properly positioned")}(t)}(t);const i=function(t,e,n){if(!t||!e||!n)return r("Invalid parameters for setupPointerListeners"),()=>{};if(!M(e))return()=>{};t.style.userSelect="none",t.style.cursor="pointer",t.style.touchAction="pan-y","static"===window.getComputedStyle(t).position&&(t.style.position="relative");L(n);const i=t=>{if(A(n),null!==n.activePointerId)return void c("Ignoring pointer down, another pointer already active");n.interactionActive=!0,n.activePointerId=t.pointerId,n.pointerStartX=t.clientX,n.pointerStartY=t.clientY,n.pointerStartTime=Date.now(),n.hasMoved=!1,n.holdTriggered=!1,n.tapPending=!0,n.tapDisabled=!1;Date.now()-n.lastHoldTime<500?c("Hold action prevented - too soon after last hold"):e.holdAction&&"none"!==e.holdAction.action&&(null!==n.holdTimer&&clearTimeout(n.holdTimer),n.holdTimer=window.setTimeout((()=>{null===n.activePointerId||n.hasMoved||!n.interactionActive||n.holdTriggered||(c("Hold timer triggered"),function(t,e,n){if(n.holdTriggered||n.hasMoved)return;n.holdTriggered=!0,n.tapPending=!1;const i=document.createElement("div");i.className="calendar-interaction-ripple hold-ripple";const a=Math.max(0,t.clientX),r=Math.max(0,t.clientY);i.style.position="fixed",i.style.top=`${r}px`,i.style.left=`${a}px`,i.style.borderRadius="50%",i.style.pointerEvents="none",i.style.zIndex="999",i.style.transform="translate(-50%, -50%)",i.style.backgroundColor="#03a9f4";try{document.body.appendChild(i),n.holdIndicator=i,requestAnimationFrame((()=>{i&&i.parentNode&&i.classList.add("active")}))}catch(t){o("Error creating hold indicator:",t)}}(t,0,n))}),500))},a=t=>{if(t.pointerId!==n.activePointerId)return;const e=t.clientX-n.pointerStartX,i=t.clientY-n.pointerStartY,a=Math.sqrt(e*e+i*i),o=16;!n.hasMoved&&a>o&&(n.hasMoved=!0,c("Movement threshold exceeded, canceling hold/tap actions"),z(n),n.tapPending=!1,A(n))},l=t=>{if(t.pointerId===n.activePointerId){n.activePointerId,n.activePointerId=null;try{if(z(n),n.holdTriggered&&!n.hasMoved)return c("Completing hold action"),function(t,e,n){if(!e.holdAction||"none"===e.holdAction.action)return;n.lastActionTime=Date.now(),n.lastHoldTime=Date.now();try{const t=e.context;k(e.holdAction,t.hass,t.element,t.entityId||"",t.toggleCallback||(()=>{})),n.holdIndicator&&n.holdIndicator.parentNode&&(n.holdIndicator.classList.add("ripple-fading"),setTimeout((()=>{if(n.holdIndicator&&n.holdIndicator.parentNode){try{document.body.removeChild(n.holdIndicator)}catch(t){}n.holdIndicator=null}}),150))}catch(t){o("Error completing hold action:",t),A(n)}t.stopPropagation(),t.preventDefault(),n.holdTriggered=!1}(t,e,n),n.lastHoldTime=Date.now(),n.tapPending=!1,void(n.tapDisabled=!0);if(n.tapPending&&!n.hasMoved&&!n.tapDisabled){const i=Date.now();i-n.lastActionTime>300?(c("Triggering tap action"),n.lastActionTime=i,function(t,e,n){if(!e.tapAction||"none"===e.tapAction.action)return;const i=t.currentTarget;s("Tap action triggered",{action:e.tapAction.action,target:null==i?void 0:i.tagName,targetClasses:null==i?void 0:i.className}),function(t,e){s("Creating ripple effect",{x:t.clientX,y:t.clientY,element:e.tagName,elementId:e.id,classes:e.className});const n=e.getBoundingClientRect();s("Card rect",{width:n.width,height:n.height,left:n.left,top:n.top});try{let i;const a=e.querySelector(".card-ripple-container");if(a){for(;a.firstChild;)a.removeChild(a.firstChild);i=a,s("Using existing ripple container")}else i=document.createElement("div"),i.className="card-ripple-container",i.style.cssText=`\n        position: absolute !important;\n        top: 0 !important;\n        left: 0 !important;\n        right: 0 !important;\n        bottom: 0 !important;\n        width: ${n.width}px !important;\n        height: ${n.height}px !important;\n        overflow: hidden !important;\n        pointer-events: none !important;\n        z-index: 1 !important;\n        border-radius: var(--ha-card-border-radius, 4px);\n      `,e.firstChild?e.insertBefore(i,e.firstChild):e.appendChild(i),s("Created new ripple container");const r=document.createElement("div");r.className="card-ripple";const c=t.clientX-n.left,l=t.clientY-n.top,d=2.5*Math.max(n.width,n.height);s("Ripple parameters",{x:c,y:l,size:d}),r.style.cssText=`\n      position: absolute !important;\n      width: ${d}px !important;\n      height: ${d}px !important;\n      left: ${c-d/2}px !important;\n      top: ${l-d/2}px !important;\n      border-radius: 50% !important;\n      background-color: var(--primary-color, currentColor) !important;\n      opacity: 0 !important;\n      transform: scale(0) !important;\n      pointer-events: none !important;\n      z-index: 1 !important;\n      will-change: transform, opacity !important;\n      animation: debug-blink 1s infinite; /* Debug animation */\n    `,i.appendChild(r),r.offsetWidth,requestAnimationFrame((()=>{s("Applying ripple animation"),r.style.transition="opacity 300ms linear, transform 300ms cubic-bezier(0.4, 0, 0.2, 1) !important",r.style.transform="scale(1) !important",r.style.opacity="0.15 !important",r.classList.add("ripple-animate")})),setTimeout((()=>{r.parentNode&&(s("Fading out ripple"),r.style.opacity="0 !important",setTimeout((()=>{try{r.parentNode&&(r.parentNode.removeChild(r),s("Removed ripple element"))}catch(t){o("Error removing ripple:",t)}}),300))}),300)}catch(t){o("Error in createRippleEffect:",t)}}(t,i),n.lastActionTime=Date.now();const a=e.context;k(e.tapAction,a.hass,a.element,a.entityId||"",a.toggleCallback||(()=>{})),t.stopPropagation(),t.preventDefault()}(t,e,n)):c("Tap action prevented - too soon after last action")}}finally{n.holdTriggered=!1,n.tapPending=!1,n.interactionActive=!1,setTimeout((()=>{null===n.activePointerId&&A(n)}),100)}}},d=t=>{t.pointerId===n.activePointerId&&(c("Pointer action canceled"),z(n),n.activePointerId=null,n.holdTriggered=!1,n.tapPending=!1,n.interactionActive=!1,A(n))},h=t=>{(n.tapDisabled||n.holdTriggered||Date.now()-n.lastHoldTime<300)&&(c("Click prevented to avoid double action"),t.stopPropagation(),t.preventDefault(),n.tapDisabled=!1)};return t.addEventListener("pointerdown",i,{passive:!1}),t.addEventListener("pointermove",a,{passive:!0}),t.addEventListener("pointerup",l,{passive:!1}),t.addEventListener("pointercancel",d,{passive:!0}),t.addEventListener("pointerleave",d,{passive:!0}),t.addEventListener("click",h,{capture:!0,passive:!1}),()=>{t.removeEventListener("pointerdown",i),t.removeEventListener("pointermove",a),t.removeEventListener("pointerup",l),t.removeEventListener("pointercancel",d),t.removeEventListener("pointerleave",d),t.removeEventListener("click",h,{capture:!0}),L(n)}}(t,e,n);return()=>{i(),L(n),s("Interaction cleanup performed")}}function z(t){null!==t.holdTimer&&(clearTimeout(t.holdTimer),t.holdTimer=null)}function A(t){if(t.holdIndicator){try{t.holdIndicator.parentNode&&t.holdIndicator.parentNode.removeChild(t.holdIndicator)}catch(t){}t.holdIndicator=null}if(t.tapRipple){try{t.tapRipple.parentNode&&t.tapRipple.parentNode.removeChild(t.tapRipple)}catch(t){}t.tapRipple=null}}function L(t){z(t),t.activePointerId=null,t.hasMoved=!1,t.holdTriggered=!1,t.tapPending=!1,t.interactionActive=!1,t.tapDisabled=!1,A(t)}function N(){var t;const e=document.getElementById("calendar-card-interaction-style");if(e)try{null===(t=e.parentNode)||void 0===t||t.removeChild(e),s("Removed existing interaction styles")}catch(t){o("Failed to remove existing styles:",t)}const n=document.createElement("style");n.id="calendar-card-interaction-style",n.textContent="\n    /* Add additional animation debugging */\n    @keyframes debug-blink {\n      0%, 100% { outline: 2px solid rgba(255,0,0,0); }\n      50% { outline: 2px solid rgba(255,0,0,0.5); }\n    }\n\n    /* Make hover effects extremely specific and important */\n    @media (hover: hover) {\n      html body .hover-effect-target,\n      html body div.card-container.card-interactive,\n      html body ha-card.card-interactive,\n      html body div.card-interactive ha-card {\n        cursor: pointer !important;\n        transition: transform 180ms ease-in-out, box-shadow 180ms ease-in-out !important;\n        will-change: transform, box-shadow !important;\n        position: relative !important;\n        overflow: visible !important;\n      }\n      \n      html body .hover-effect-target:hover,\n      html body div.card-container.card-interactive:hover,\n      html body ha-card.card-interactive:hover,\n      html body div.card-interactive ha-card:hover {\n        box-shadow: var(--ha-card-box-shadow, \n                     0 2px 2px 0 rgba(0, 0, 0, 0.14), \n                     0 1px 5px 0 rgba(0, 0, 0, 0.12), \n                     0 3px 1px -2px rgba(0, 0, 0, 0.2)) !important;\n        transform: translateY(-2px) !important;\n        z-index: 1 !important;\n      }\n    }\n\n    /* Direct inline style version of ripple container */\n    .card-ripple-container {\n      position: absolute !important;\n      top: 0 !important;\n      left: 0 !important;\n      right: 0 !important;\n      bottom: 0 !important;\n      overflow: hidden !important;\n      border-radius: var(--ha-card-border-radius, 4px) !important;\n      pointer-events: none !important;\n      z-index: 1 !important;\n      width: 100% !important;\n      height: 100% !important;\n    }\n\n    /* Force visiblity of ripples */\n    .card-ripple {\n      position: absolute !important;\n      border-radius: 50% !important;\n      background-color: var(--primary-color, currentColor) !important; \n      opacity: 0 !important;\n      pointer-events: none !important;\n      z-index: 1 !important;\n      will-change: transform, opacity !important;\n    }\n    \n    /* Utility class for animations */\n    .ripple-animate {\n      opacity: 0.15 !important;\n      transform: scale(1) !important;\n      transition: opacity 300ms linear, transform 300ms cubic-bezier(0.4, 0, 0.2, 1) !important;\n    }\n\n    /* Rest of styles omitted for brevity... */\n    /* ...existing styles... */\n  ",document.head.appendChild(n),s("Global interaction styles applied with enhanced visibility")}function M(t){var e,n;return t&&(t.tapAction||t.holdAction)&&("none"!==(null===(e=t.tapAction)||void 0===e?void 0:e.action)||"none"!==(null===(n=t.holdAction)||void 0===n?void 0:n.action))||!1}function F(t,e){const n=new CustomEvent("hass-more-info",{detail:{entityId:e},bubbles:!0,composed:!0,cancelable:!1});t.dispatchEvent(n)}function R(t){t.navigation_path&&(window.history.pushState(null,"",t.navigation_path),window.dispatchEvent(new Event("location-changed")))}function P(t,e){if(!e.service)return;const[n,i]=e.service.split(".");if(!n||!i)return void o(`Invalid service: ${e.service}`);const a=e.service_data||{};t.callService(n,i,a)}function O(t){t.url_path&&window.open(t.url_path,"_blank")}function j(t,e){let n;return(...i)=>{clearTimeout(n),n=window.setTimeout((()=>{clearTimeout(n),t(...i)}),e)}}function U(t,e){const n=new Map;return Object.assign(((...i)=>{const a=JSON.stringify(i);if(n.has(a))return n.get(a);const o=e?t.call(e,...i):t(...i);return n.set(a,o),o}),{cache:n,clear:()=>n.clear()})}function H(t){return{startTime:performance.now(),eventCount:t}}function W(t){if(!t.renderTime.length)return 0;return t.renderTime.reduce(((t,e)=>t+e),0)/t.renderTime.length}function B(t,e,n){return function(t){let e=0;for(let n=0;n<t.length;n++){e=(e<<5)-e+t.charCodeAt(n),e|=0}return Math.abs(e).toString(36)}(`calendar_${t.map((t=>"string"==typeof t?t:t.entity)).sort().join("_")}_${e}_${n?1:0}`)}N(),function(){if(!document.getElementById("calendar-card-shadow-styles")){const t=document.createElement("style");t.id="calendar-card-shadow-styles",t.textContent='\n      /* Define custom properties for interactions */\n      html {\n        --calendar-card-hover-transform: translateY(-2px);\n        --calendar-card-hover-shadow: var(--ha-card-box-shadow, \n                                      0 2px 2px 0 rgba(0, 0, 0, 0.14), \n                                      0 1px 5px 0 rgba(0, 0, 0, 0.12), \n                                      0 3px 1px -2px rgba(0, 0, 0, 0.2));\n        --calendar-card-ripple-color: var(--primary-color, currentColor);\n        --calendar-card-ripple-opacity: 0.15;\n      }\n      \n      /* Boost selector specificity for hover effects */\n      html body .hover-effect-target:hover,\n      html body div.card-container.card-interactive:hover,\n      html body ha-card.card-interactive:hover,\n      html body div.card-interactive ha-card:hover,\n      html body *[data-interactive="true"]:hover {\n        box-shadow: var(--calendar-card-hover-shadow) !important;\n        transform: var(--calendar-card-hover-transform) !important;\n        z-index: 1 !important;\n      }\n      \n      /* Force extra visibility on ripples */\n      html body .card-ripple {\n        visibility: visible !important;\n        display: block !important;\n        opacity: var(--calendar-card-ripple-opacity) !important;\n      }\n    ',document.head.appendChild(t),s("Applied global shadow DOM interaction styles")}}(),s("Interaction module initialized");const Y=100,G=10,J=50;function X(){return{beginMeasurement:H,endMeasurement:(t,e,n)=>function(t,e,n){const i=performance.now()-t.startTime,a=e;a.renderTime.push(i),a.renderTime.length>10&&a.renderTime.shift();const o=W(e);return o>n&&r("Poor rendering performance detected",{averageRenderTime:o,eventCount:t.eventCount}),i}(t,e,n||Y),getAverageRenderTime:W}}function K(t){t.join("_"),function(){try{const t=[],e=Date.now();Object.keys(localStorage).filter((t=>t.startsWith("calendar_data_"))).forEach((n=>{try{const i=JSON.parse(localStorage.getItem(n)||"");e-i.timestamp>864e5&&t.push(n)}catch(e){t.push(n)}})),t.length>0&&(s(`Cleaned up ${t.length} old cache entries`),t.forEach((t=>localStorage.removeItem(t))))}catch(t){r("Cache cleanup failed:",t)}}()}function q(t){return`\n    ${function(t){return`\n    :host {\n      --card-font-size-title: ${t.title_font_size};\n      --card-font-size-weekday: ${t.weekday_font_size};\n      --card-font-size-day: ${t.day_font_size};\n      --card-font-size-month: ${t.month_font_size};\n      --card-font-size-event: ${t.event_font_size};\n      --card-font-size-time: ${t.time_font_size};\n      --card-font-size-location: ${t.location_font_size};\n      --card-color-title: ${t.title_color};\n      --card-color-weekday: ${t.weekday_color};\n      --card-color-day: ${t.day_color};\n      --card-color-month: ${t.month_color};\n      --card-color-event: ${t.event_color};\n      --card-color-time: ${t.time_color};\n      --card-color-location: ${t.location_color};\n      --card-line-color-vertical: ${t.vertical_line_color};\n      --card-line-color-horizontal: ${t.horizontal_line_color};\n      --card-line-width-vertical: ${t.vertical_line_width};\n      --card-line-width-horizontal: ${t.horizontal_line_width};\n      --card-spacing-row: ${t.row_spacing};\n      --card-spacing-additional: ${t.additional_card_spacing};\n      --card-icon-size: ${t.time_location_icon_size};\n      --card-date-column-width: ${1.75*parseFloat(t.day_font_size)}px;\n      --card-custom-background: ${t.background_color};\n    }\n  `}(t)}\n    \n    :host {\n      display: block;\n    }\n    .card-container {\n      cursor: pointer;\n      width: 100%;\n      height: 100%;\n    }\n    .card-content {\n      background: var(--card-custom-background, var(--card-background-color, #FFF));\n      border: var(--ha-card-border-width, 1px) solid var(--ha-card-border-color, var(--divider-color));\n      border-radius: var(--ha-card-border-radius, 10px);\n      padding: 16px;\n      padding-top: calc(16px + var(--card-spacing-additional));\n      padding-bottom: calc(16px + var(--card-spacing-additional));\n    }\n    .title {\n      font-size: var(--card-font-size-title);\n      line-height: var(--card-font-size-title);\n      font-weight: 500;\n      color: var(--card-color-title);\n      margin-bottom: 16px;\n    }\n    ha-icon {\n      margin-right: 4px;\n      --mdc-icon-size: var(--card-icon-size);\n      vertical-align: middle;\n      position: relative;\n    }\n    table {\n      width: 100%;\n      table-layout: fixed;\n      border-spacing: 0;\n      margin-bottom: var(--card-spacing-row);\n      border-bottom: var(--card-line-width-horizontal) solid var(--card-line-color-horizontal);\n      padding-bottom: var(--card-spacing-row);\n    }\n    .date {\n      width: var(--card-date-column-width);\n      text-align: center;\n      padding-right: 12px;\n      border-right: var(--card-line-width-vertical) solid var(--card-line-color-vertical);\n    }\n    .weekday {\n      font-size: var(--card-font-size-weekday);\n      line-height: var(--card-font-size-weekday);\n      color: var(--card-color-weekday);\n    }\n    .day {\n      font-size: var(--card-font-size-day);\n      line-height: var(--card-font-size-day);\n      font-weight: 500;\n      color: var(--card-color-day);\n    }\n    .month {\n      font-size: var(--card-font-size-month);\n      line-height: var(--card-font-size-month);\n      text-transform: uppercase;\n      color: var(--card-color-month);\n    }\n    .event {\n      padding-left: 12px;\n    }\n    .event-title {\n      font-size: var(--card-font-size-event);\n      font-weight: 500;\n      color: var(--card-color-event);\n    }\n    .time-location {\n      display: flex;\n      flex-direction: column;\n      margin-top: 0px;\n    }\n    .time, .location {\n      display: flex;\n      align-items: center;\n      line-height: 1.2;\n    }\n    .time {\n      font-size: var(--card-font-size-time);\n      color: var(--card-color-time);\n    }\n    .location {\n      font-size: var(--card-font-size-location);\n      color: var(--card-color-location);\n      margin-top: 2px;\n    }\n    table:last-of-type {\n      margin-bottom: 0;\n      border-bottom: 0;\n      padding-bottom: 0;\n    }\n    .no-events {\n      text-align: center;\n      color: var(--secondary-text-color);\n      font-style: italic;\n      padding: 16px;\n    }\n  \n  `}function V(t){for(;t.firstChild;)t.removeChild(t.firstChild)}async function Z(t,e,n,i,a,o){const r=document.createElement("div");r.className="card-container card-interactive hover-effect-target",r.style.position="relative",r.style.overflow="hidden",r.style.display="block",r.style.width="100%",r.style.height="100%",r.style.boxSizing="border-box";const s=document.createElement("div");s.className="card-content",s.style.position="relative",s.style.zIndex="2";const c=document.createElement("div");if(c.className="card-ripple-container",t.title){const e=document.createElement("h2");e.className="title",e.textContent=t.title,s.appendChild(e)}const l=await async function(t,e,n,i,a=10,o=50){if(!t.length){const t=document.createDocumentFragment(),e=document.createElement("div");return e.className="no-events",e.textContent="No upcoming events",t.appendChild(e),t}const r=document.createDocumentFragment(),s=async c=>{const l=t.slice(c,c+a);l.length&&(l.forEach((t=>{if(0===t.events.length)return;const a=document.createElement("table");a.innerHTML=tt(t,e,n,i),r.appendChild(a)})),c+a<t.length&&(await new Promise((t=>setTimeout(t,o))),await s(c+a)))};return await s(0),r}(e,t,n,i,a,o);s.appendChild(l),r.appendChild(c),r.appendChild(s);const d=document.createElement("style");return d.textContent=q(t),{container:r,style:d}}function Q(t,e,n){V(t);const i=function(t,e){if("loading"===t){const t=document.createElement("div");t.className="card-container";const n=document.createElement("div");n.className="card-content",n.innerHTML=`\n      <div style="text-align: center; color: var(--primary-text-color);">\n        ${u(e.language,"loading")}\n      </div>`,t.appendChild(n);const i=document.createElement("style");return i.textContent=q(e),{container:t,style:i}}if("empty"===t){const t=new Date,n={weekday:v(e.language,t.getDay()),day:t.getDate(),month:g(e.language,t.getMonth()),events:[{summary:u(e.language,"noEvents"),time:"",location:"",_entityConfig:{color:"var(--secondary-text-color)"}}]},i=document.createElement("div");i.className="card-container";const a=document.createElement("div");a.className="card-content",a.innerHTML=`\n      <table>\n        <tr>\n          <td class="date" rowspan="1">\n            <div class="date-content">\n              <div class="weekday">${n.weekday}</div>\n              <div class="day">${n.day}</div>\n              ${e.show_month?`<div class="month">${n.month}</div>`:""}\n            </div>\n          </td>\n          <td class="event">\n            <div class="event-content">\n              <div class="event-title" style="color: ${n.events[0]._entityConfig.color}">\n                ${n.events[0].summary}\n              </div>\n            </div>\n          </td>\n        </tr>\n      </table>`,i.appendChild(a);const o=document.createElement("style");return o.textContent=q(e),{container:i,style:o}}const n={error:`<p style="color: var(--error-color, red);">${u(e.language,"error")}</p>`,loading:`<p style="color: var(--secondary-text-color);">${u(e.language,"loading")}</p>`},i=`\n    <div class="card-content">\n      ${n[t]}\n    </div>\n  `,a="\n    .card-content {\n      background: var(--card-background-color, #FFF);\n      border: var(--ha-card-border-width, 1px) solid var(--ha-card-border-color, var(--divider-color));\n      border-radius: var(--ha-card-border-radius, 10px);\n      padding: 16px;\n      color: var(--primary-text-color);\n      text-align: center;\n    }\n  ";return{html:i,styleText:a}}(e,n);"container"in i&&"style"in i?(t.appendChild(i.style),t.appendChild(i.container)):t.innerHTML=`\n      <style>${i.styleText}</style>\n      ${i.html}\n    `}function tt(t,e,n,i){return t.events.map(((a,o)=>{var r;return`\n    <tr>\n      ${0===o?`\n        <td class="date" rowspan="${t.events.length}">\n          <div class="date-content">\n            <div class="weekday">${t.weekday}</div>\n            <div class="day">${t.day}</div>\n            ${e.show_month?`<div class="month">${t.month}</div>`:""}\n          </div>\n        </td>\n      `:""}\n      <td class="event">\n        <div class="event-content">\n          <div class="event-title" style="color: ${null===(r=a._entityConfig)||void 0===r?void 0:r.color}">${a.summary}</div>\n          <div class="time-location">\n            <div class="time">\n              <ha-icon icon="hass:clock-outline"></ha-icon>\n              <span>${n(a)}</span>\n            </div>\n            ${a.location&&e.show_location?`\n              <div class="location">\n                <ha-icon icon="hass:map-marker"></ha-icon>\n                <span>${i(a.location)}</span>\n              </div>\n            `:""}\n          </div>\n        </div>\n      </td>\n    </tr>\n  `})).join("")}class et extends HTMLElement{setConfig(t){}}
/**
 * Calendar Card Pro for Home Assistant
 *
 * This is the main entry point for the Calendar Card Pro custom card.
 * It orchestrates the different modules and handles the core web component lifecycle.
 *
 * Design inspired by Home Assistant community member @GHA_Steph's button-card calendar design
 * https://community.home-assistant.io/t/calendar-add-on-some-calendar-designs/385790
 *
 * Interaction patterns inspired by Home Assistant's Tile Card
 * and Material Design, both licensed under the Apache License 2.0.
 * https://github.com/home-assistant/frontend/blob/dev/LICENSE.md
 *
 * @license MIT
 * @version 0.1.0
 */const nt="0.1.0";class it extends HTMLElement{static get DEFAULT_CONFIG(){return l}static get TRANSLATIONS(){return p}static findCalendarEntity(t){return h(t.states)}static getStubConfig(t){return function(t){const e=h(t);return{type:"custom:calendar-card-pro-dev",entities:e?[e]:[],days_to_show:3,show_location:!0,_description:e?void 0:"A calendar card that displays events from multiple calendars with individual styling. Add a calendar integration to Home Assistant to use this card."}}(t.states)}static get displayName(){return"Calendar Card Pro"}constructor(){super(),this.events=[],this._hass=null,this.touchState={touchStartY:0,touchStartX:0,holdTimer:null,holdTriggered:!1},this.isLoading=!0,this.isExpanded=!1,this.performanceMetrics={renderTime:[],eventCount:0,lastUpdate:Date.now()},this.eventListenerCleanup=null,this.attachShadow({mode:"open"}),this.instanceId=Math.random().toString(36).substring(2,15),this.initializeState(),a(nt),this.performanceTracker=X(),this.visibilityCleanup=function(t,e){const n=()=>{"visible"===document.visibilityState&&Date.now()-e()>3e5&&t()};return document.addEventListener("visibilitychange",n),()=>document.removeEventListener("visibilitychange",n)}((()=>this.updateEvents()),(()=>this.performanceMetrics.lastUpdate)),this.refreshTimer=function(t,e){let n;const i=()=>{void 0!==n&&(clearInterval(n),n=void 0,c("Stopped refresh timer"))};return{start:()=>{i();const a=e();n=window.setInterval((()=>t(!0)),6e4*a),c(`Started refresh timer with interval ${a} minutes`)},stop:i}}(((t=!1)=>this.updateEvents(t)),(()=>{var t;return(null===(t=this.config)||void 0===t?void 0:t.refresh_interval)||30})),this.debouncedUpdate=j((()=>this.updateEvents()),300),this.memoizedFormatTime=U((t=>y(t,this.config.time_24h)),this),this.memoizedFormatLocation=U((t=>w(t,this.config.remove_location_country)),this),this.cleanupInterval=window.setInterval((()=>this.cleanupCache()),36e5),this.refreshTimer.start()}disconnectedCallback(){this.visibilityCleanup&&this.visibilityCleanup(),this.refreshTimer&&this.refreshTimer.stop(),clearInterval(this.cleanupInterval),this.cleanup(),this.eventListenerCleanup&&(this.eventListenerCleanup(),this.eventListenerCleanup=null)}formatLocation(t){return w(t,this.config.remove_location_country)}initializeState(){const t={config:{},events:[],hass:null,touchState:{touchStartY:0,touchStartX:0,holdTimer:null,holdTriggered:!1},isLoading:!0,isExpanded:!1};this.config=t.config,this.events=t.events,this._hass=t.hass,this.touchState=t.touchState,this.isLoading=t.isLoading,this.isExpanded=t.isExpanded}cleanup(){var t,e,n;t=this.renderTimeout,e=this.memoizedFormatTime,n=this.memoizedFormatLocation,t&&clearTimeout(t),e.cache.clear(),n.cache.clear()}cleanupCache(){K(this.config.entities)}get translations(){return m(this.config.language||"en")}set hass(t){const e=this._hass;this._hass=t;this.config.entities.some((n=>{var i,a;return!e||(null===(i=e.states["string"==typeof n?n:n.entity])||void 0===i?void 0:i.state)!==(null===(a=t.states["string"==typeof n?n:n.entity])||void 0===a?void 0:a.state)}))&&this.updateEvents()}setConfig(t){const e=this.config;var n;this.config=Object.assign(Object.assign({},it.DEFAULT_CONFIG),t),this.config.entities=(n=this.config.entities,Array.isArray(n)?n.map((t=>"string"==typeof t?{entity:t,color:"var(--primary-text-color)"}:"object"==typeof t&&t.entity?{entity:t.entity,color:t.color||"var(--primary-text-color)"}:null)).filter(Boolean):[]),this.instanceId=B(this.config.entities,this.config.days_to_show,this.config.show_past_events);d(e,this.config)?(s("Configuration changed, refreshing data"),this.updateEvents(!0)):this.renderCard(),this.refreshTimer&&this.refreshTimer.start()}invalidateCache(){!function(t){try{const e=t.filter((t=>null!==localStorage.getItem(t)&&(localStorage.removeItem(t),!0)));e.length>0&&s(`Invalidated ${e.length} cache entries`)}catch(t){r("Failed to invalidate cache:",t)}}(D(E(this.instanceId,this.config.entities,this.config.days_to_show,this.config.show_past_events,this.config)))}getAllCacheKeys(){return D(this.getBaseCacheKey())}getCacheKey(){return this.getBaseCacheKey()}getBaseCacheKey(){const{entities:t,days_to_show:e,show_past_events:n}=this.config;return E(this.instanceId,t,e,n,this.config)}isValidState(){return x(this._hass,this.config.entities)}async updateEvents(t=!1){await _({hass:this._hass,config:this.config,instanceId:this.instanceId,force:t,currentEvents:this.events,callbacks:{setLoading:t=>{this.isLoading=t},setEvents:t=>{this.events=t},updateLastUpdate:()=>{this.performanceMetrics.lastUpdate=Date.now()},renderCallback:()=>{this.renderCard()}}})}handleAction(t){const e=S(this.config.entities);k(t,this._hass,this,e,(()=>this.toggleExpanded()))}fireMoreInfo(){F(this,S(this.config.entities))}handleNavigation(t){R(t)}callService(t){this._hass&&P(this._hass,t)}openUrl(t){O(t)}toggleExpanded(){this.config.max_events_to_show&&(this.isExpanded=!this.isExpanded,this.renderCard())}formatEventTime(t){return f(t,this.config,this.config.language)}getTimeWindow(){return C(this.config.days_to_show)}async renderCard(){var t,e,n,i,a;const r=this.performanceTracker.beginMeasurement(this.events.length);if(!this.isValidState())return Q(this.shadowRoot,"error",this.config),void this.performanceTracker.endMeasurement(r,this.performanceMetrics);if(this.isLoading)return Q(this.shadowRoot,"loading",this.config),void this.performanceTracker.endMeasurement(r,this.performanceMetrics);const c=function(t,e,n,i){const a={},o=new Date,r=new Date(o.getFullYear(),o.getMonth(),o.getDate()),s=new Date(r);s.setHours(23,59,59,999);const c=t.filter((t=>{if(!(null==t?void 0:t.start)||!(null==t?void 0:t.end))return!1;const n=t.start.dateTime?new Date(t.start.dateTime):t.start.date?new Date(t.start.date):null,i=t.end.dateTime?new Date(t.end.dateTime):t.end.date?new Date(t.end.date):null;if(!n||!i)return!1;const a=!t.start.dateTime;return!(!(n>=r&&n<=s||n>s)||!e.show_past_events&&!a&&i<o)}));if(0===c.length)return[];c.forEach((t=>{const n=t.start.dateTime?new Date(t.start.dateTime):t.start.date?new Date(t.start.date):null;if(!n)return;const o=n.toISOString().split("T")[0],r=m(i);a[o]||(a[o]={weekday:r.daysOfWeek[n.getDay()],day:n.getDate(),month:r.months[n.getMonth()],timestamp:n.getTime(),events:[]}),a[o].events.push({summary:t.summary||"",time:f(t,e,i),location:e.show_location?w(t.location||"",e.remove_location_country):"",start:t.start,end:t.end,_entityConfig:t._entityConfig})})),Object.values(a).forEach((t=>{t.events.sort(((t,e)=>(t.start.dateTime?new Date(t.start.dateTime).getTime():t.start.date?new Date(t.start.date).getTime():0)-(e.start.dateTime?new Date(e.start.dateTime).getTime():e.start.date?new Date(e.start.date).getTime():0)))}));let l=Object.values(a).sort(((t,e)=>t.timestamp-e.timestamp)).slice(0,e.days_to_show||3);if(e.max_events_to_show&&!n){let t=0;l=l.filter((n=>{var i;return!(t>=(null!==(i=e.max_events_to_show)&&void 0!==i?i:0)||(t+=n.events.length,0))}))}return l}(this.events,this.config,this.isExpanded,this.config.language);if(0===c.length)return Q(this.shadowRoot,"empty",this.config),void this.performanceTracker.endMeasurement(r,this.performanceMetrics);try{const{container:o,style:r}=await Z(this.config,c,(t=>this.formatEventTime(t)),(t=>this.formatLocation(t)),G,J);V(this.shadowRoot);const l=document.createElement("style");l.id="direct-interaction-styles",l.textContent="\n        /* Direct Hover Effect Styles */\n        @media (hover: hover) {\n          .card-container {\n            transition: transform 180ms ease-in-out, box-shadow 180ms ease-in-out !important;\n            will-change: transform, box-shadow !important;\n          }\n          \n          .card-container:hover {\n            box-shadow: var(--ha-card-box-shadow, \n                        0 2px 2px 0 rgba(0, 0, 0, 0.14), \n                        0 1px 5px 0 rgba(0, 0, 0, 0.12), \n                        0 3px 1px -2px rgba(0, 0, 0, 0.2)) !important;\n            transform: translateY(-2px) !important;\n          }\n        }\n        \n        /* Direct Ripple Styles */\n        .card-ripple-container {\n          position: absolute !important;\n          top: 0 !important;\n          left: 0 !important;\n          right: 0 !important;\n          bottom: 0 !important;\n          overflow: hidden !important;\n          pointer-events: none !important;\n          z-index: 1 !important;\n        }\n        \n        .card-ripple {\n          position: absolute !important;\n          border-radius: 50% !important;\n          background-color: var(--primary-color, currentColor) !important;\n          opacity: 0;\n          pointer-events: none !important;\n          transition: opacity 300ms linear, transform 300ms cubic-bezier(0.4, 0, 0.2, 1) !important;\n          z-index: 1 !important;\n        }\n        \n        .ripple-animate {\n          opacity: 0.15 !important;\n          transform: scale(1) !important;\n        }\n      ",null===(t=this.shadowRoot)||void 0===t||t.appendChild(l),null===(e=this.shadowRoot)||void 0===e||e.appendChild(r),null===(n=this.shadowRoot)||void 0===n||n.appendChild(o),this.eventListenerCleanup&&(this.eventListenerCleanup(),this.eventListenerCleanup=null),o instanceof HTMLDivElement&&(o.style.position="relative",o.style.overflow="hidden",o.style.cursor="pointer",o.style.transform="translateZ(0)",o.style.backfaceVisibility="hidden",("true"===localStorage.getItem("calendar-card-debug")||window.location.search.includes("debug=true"))&&(o.style.outline="1px dashed rgba(0,255,0,0.2)"),s("Setting up card interactions",{hasInteractions:Boolean(this.config.tap_action||this.config.hold_action),tapAction:null===(i=this.config.tap_action)||void 0===i?void 0:i.action,holdAction:null===(a=this.config.hold_action)||void 0===a?void 0:a.action}),this.eventListenerCleanup=I(o,{tapAction:this.config.tap_action,holdAction:this.config.hold_action,context:{element:this,hass:this._hass,entityId:S(this.config.entities),toggleCallback:()=>this.toggleExpanded()}}),o.addEventListener("pointerdown",(t=>{const e=o.querySelector(".card-ripple-container");if(e){const n=o.getBoundingClientRect(),i=t.clientX-n.left,a=t.clientY-n.top,r=2*Math.max(n.width,n.height),s=document.createElement("div");s.className="card-ripple",s.style.position="absolute",s.style.width=`${r}px`,s.style.height=`${r}px`,s.style.left=i-r/2+"px",s.style.top=a-r/2+"px",s.style.opacity="0",s.style.transform="scale(0)",e.appendChild(s),s.offsetWidth,s.style.opacity="0.15",s.style.transform="scale(1)",setTimeout((()=>{s.style.opacity="0",setTimeout((()=>{s.parentNode&&s.parentNode.removeChild(s)}),300)}),300)}})))}catch(t){o("Render error:",t),Q(this.shadowRoot,"error",this.config)}this.performanceTracker.endMeasurement(r,this.performanceMetrics)}renderError(t){Q(this.shadowRoot,t,this.config)}generateCalendarContent(t){return function(t,e,n,i){return t.length?t.map((t=>0===t.events.length?"":`<table>${t.events.map(((a,o)=>`\n      <tr>\n        ${0===o?`\n          <td class="date" rowspan="${t.events.length}">\n            <div class="date-content">\n              <div class="weekday">${t.weekday}</div>\n              <div class="day">${t.day}</div>\n              ${e.show_month?`<div class="month">${t.month}</div>`:""}\n            </div>\n          </td>\n        `:""}\n        <td class="event">\n          <div class="event-content">\n            <div class="event-title">${a.summary}</div>\n            <div class="time-location">\n              <div class="time">\n                <ha-icon icon="hass:clock-outline"></ha-icon>\n                <span>${n(a)}</span>\n              </div>\n              ${a.location&&e.show_location?`\n                <div class="location">\n                  <ha-icon icon="hass:map-marker"></ha-icon>\n                  <span>${i(a.location)}</span>\n                </div>\n              `:""}\n            </div>\n          </div>\n        </td>\n      </tr>\n    `)).join("")}</table>`)).join(""):'<div class="no-events">No upcoming events</div>'}(t,this.config,(t=>this.formatEventTime(t)),(t=>this.formatLocation(t)))}generateDayContent(t){return tt(t,this.config,(t=>this.formatEventTime(t)),(t=>this.formatLocation(t)))}getStyles(){return q(this.config)}debounce(t,e){return j(t,e)}memoize(t){return U(t,this)}getAverageRenderTime(){return this.performanceTracker.getAverageRenderTime(this.performanceMetrics)}handleError(t){var e;o(`Error: ${(e=t)instanceof Error?e.message:String(e)}`),e instanceof Error&&e.stack&&console.error(e.stack)}}customElements.define("calendar-card-pro-dev",it),customElements.define("calendar-card-pro-dev-editor",et),window.customCards=window.customCards||[],window.customCards.push({type:"calendar-card-pro-dev",name:"Calendar Card Pro",preview:!0,description:"A calendar card that supports multiple calendars with individual styling.",documentationURL:"https://github.com/alexpfau/calendar-card-pro"});export{nt as VERSION};
//# sourceMappingURL=calendar-card-pro.js.map
